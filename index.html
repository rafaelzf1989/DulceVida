<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dulce Vida - Tienda</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <link rel="icon" type="image/png" href="https://file.garden/aEX2yhToiQk-s_Qq/Dulce%20Vida/favicon.png">
  <style>
    html,body { margin:0; padding:0; background:#f5f5f8; font-family:Arial,sans-serif; min-height:100vh; }
    header { background: #fff; box-shadow: 0 2px 8px #0001; text-align: center; padding: 0;}
    .cabecera-wrap { display: flex; justify-content: center; align-items: center; width: 100%; }
    #cabeceraImg {
      width:330px; max-width:95vw; height:110px; max-height:22vw; object-fit:contain; display:block; margin:0 auto; border-radius:20px;
      background:#fff;
    }
    @media (max-width: 480px){
      #cabeceraImg { width: 99vw; height:70px; max-height:22vw; border-radius:0; }
    }
    .marquesina { background: #25D366; color: #fff; font-weight: bold; font-size: .97em; overflow:hidden; height: 29px; display:flex;align-items:center; }
    .marquesina .scroll { white-space:nowrap; display:inline-block; will-change: transform; padding-left:100vw;}
    @keyframes scroll-lr { 0% { transform:translateX(0);} 100% { transform:translateX(-100%);} }
    main { max-width: 700px; margin: 0 auto; padding: 0 0 50px 0; }
    .productos-grid { display:flex; flex-wrap:wrap; gap:17px; justify-content:center; margin:18px 0 0 0;}
    .producto-card { background:#fff; border-radius:22px; box-shadow:0 2px 10px #3b2eae1a; padding:13px 0 15px 0; width:330px; max-width:95vw; display:flex; flex-direction:column; align-items:center; position:relative; overflow:hidden; }
    .producto-card img { width:100%; height:170px; object-fit:cover; border-radius:15px 15px 0 0; margin-bottom:6px; background:#f3f3f5; border-bottom:1px solid #eee; cursor:pointer;}
    .producto-nombre { font-weight:bold; color:#3b2eae; font-size:1.09em; padding:3px 0; text-align:center; }
    .producto-precio { color:#25D366; font-weight: bold; font-size:1.03em; margin-bottom:.2em;}
    .producto-estado { display:inline-block; margin-bottom:2px; margin-top:8px; margin-left:10px; text-align:left; background:#3b2eae; color:#fff; font-size:0.81em; font-weight:bold; padding:3px 11px; border-radius:7px; box-shadow:0 1px 5px #3b2eae11; max-width:90%; white-space:nowrap;}
    .producto-card.agotado, .producto-card .producto-estado.agotado { opacity:0.98; pointer-events:none; background: #d2d2d2 !important; }
    .producto-card .producto-estado.agotado { background:#c0392b;}
    .producto-card .agotado-marca { 
      position:absolute; left:-54px; top:38px; z-index:5; 
      width:260px; color:#fff; opacity:0.5; font-size:2.1em; 
      font-weight:bold; text-align:center; 
      transform:rotate(-24deg); pointer-events:none;
      text-shadow: 1px 1px 6px #000;
      user-select:none;
      }
    .producto-desc { font-size:0.99em; color:#222; min-height:38px; text-align:center; }
    .rellenos-lista { width:92%; margin:8px auto 6px auto; display:flex; flex-direction:column; gap:4px;}
    .relleno-row,.cantidad-row { display:flex; align-items:center; gap:7px; font-size:.96em; justify-content:center;}
    .relleno-nombre, .cantidad-nombre { flex:1; }
    .relleno-btn, .cantidad-btn { background:#25D366;color:#fff;border:none;border-radius:50%;width:25px;height:25px;font-weight:bold;font-size:1.1em;cursor:pointer;transition:background 0.18s;}
    .relleno-btn:disabled, .cantidad-btn:disabled { background:#ddd; color:#aaa; cursor:not-allowed;}
    .relleno-cant, .cantidad-cant { width:21px; text-align:center; font-weight:bold; }
    .producto-agregar { margin-top:8px; background:linear-gradient(60deg,#3b2eae 70%, #25D366 100%); color:#fff; border:none; border-radius:9px; font-weight:bold; font-size:1.08em; padding: 8px 28px; cursor:pointer; box-shadow:0 2px 10px #3b2eae11;}
    #errorMsg { color: #c0392b; background: #fff6f6; border: 1px solid #e74c3c; padding: 16px; border-radius: 10px; max-width: 400px; margin: 30px auto; font-size: 1.15em; display:none; text-align:center;}
    #tryAgain { background: #25D366; color: #fff; border: none; border-radius: 6px; padding: 7px 15px; font-weight: bold; margin-top: 10px; font-size: 1em; cursor: pointer;}
    #carritoFlotante { position: fixed; bottom: 18px; right: 13px; z-index: 999; background:linear-gradient(60deg,#3b2eae 70%, #25D366 100%); color:#fff; font-size:1.12em; border-radius:33px; padding:10px 24px 10px 18px; box-shadow:0 2px 14px #231d662c; cursor:pointer; font-weight:bold; display:flex;align-items:center; gap:11px;}
    @media(max-width:400px){
      .producto-card{max-width:99vw; padding:9px 0 13px 0;}
      #cabeceraImg{max-width:100vw;}
      #carritoBox, #cliente { max-width: 99vw; }
      #carritoFlotante{font-size:0.95em;padding:8px 12px 8px 12px;}
    }
    #carritoBox { background:#fff; border-radius:14px; box-shadow:0 2px 10px #3b2eae1a; margin:18px auto 0 auto; padding:13px 12px 6px 12px; max-width:330px; width:99vw;}
    #carritoBox h2 { font-size:1.07em; color:#3b2eae; margin-bottom:7px;}
    .carrito-item { display:flex; align-items:center; gap:6px; border-bottom:1px solid #eee; padding:4px 0; font-size:1em;}
    .carrito-img { width:28px; height:28px; border-radius:6px; object-fit:cover; margin-right:7px; border:1px solid #eee; background:#fafafa;}
    .carrito-cant { width:29px; text-align:center; font-weight:bold;}
    .carrito-btn { background:#25D366;color:#fff;border:none;border-radius:50%;width:21px;height:21px;font-size:1em;font-weight:bold;cursor:pointer;margin:0 1px;}
    .carrito-btn:disabled{background:#ddd;color:#aaa;}
    .carrito-totals-row,.carrito-total-row{display:flex;justify-content:space-between;margin-top:2px;font-size:.98em;}
    .carrito-total-row{font-weight:bold;color:#3b2eae;font-size:1.13em;}
    .carrito-total-valor{font-weight:bold;color:#25D366;}
    .carrito-totals-row label, .carrito-total-row label {font-weight:bold;}
    .empty-cart{text-align:center;color:#aaa;font-style:italic;margin:12px 0;}
    #cliente{background:#fff;border-radius:14px;box-shadow:0 2px 10px #3b2eae1a;margin:18px auto 25px auto;padding:11px 12px 8px 12px;max-width:330px;width:99vw;}
    #cliente h3{color:#3b2eae;margin-bottom:8px;font-size:1.1em;}
    #clienteForm label{font-weight:bold;color:#3b2eae;margin-top:7px;display:block;}
    #clienteForm input,#clienteForm select,#clienteForm textarea{margin-bottom:8px;padding:6px 9px;border-radius:7px;border:1px solid #ccc;width:100%;font-size:1em;box-sizing:border-box;}
    #clienteForm textarea{min-height:52px;}
    #clienteForm button{background:linear-gradient(60deg,#3b2eae 70%, #25D366 100%);color:#fff;border:none;border-radius:10px;font-weight:bold;font-size:1.08em;padding:8px 22px;margin-top:9px;cursor:pointer;box-shadow:0 2px 10px #3b2eae11;display:flex;align-items:center;gap:7px;}
    #mensajeCompra{color:#25D366;font-weight:bold;text-align:center;margin:10px 0 0 0;}
    .modal-bg{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.2);z-index:9999;display:flex;align-items:center;justify-content:center;}
    .modal-confirm{background:#fff;padding:17px 15px 15px 15px;border-radius:13px;box-shadow:0 2px 12px #3b2eae22;max-width:330px;width:96vw;font-size:1.03em;}
    .modal-confirm h2{font-size:1.12em;color:#3b2eae;}
    .modal-section{margin:7px 0 6px 0;}
    .modal-total-row{display:flex;justify-content:space-between;font-weight:bold;color:#25D366;font-size:1.1em;}
    .modal-btns{display:flex;gap:14px;justify-content:flex-end;margin-top:15px;}
    .btn-confirmar{background:#25D366;color:#fff;padding:7px 20px;border-radius:8px;font-weight:bold;font-size:1em;border:none;cursor:pointer;}
    .btn-cancelar{background:#eee;color:#3b2eae;padding:7px 15px;border-radius:8px;font-weight:bold;font-size:.98em;border:none;cursor:pointer;}
    #imgModal {position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);z-index:99999;display:flex;align-items:center;justify-content:center;}
    #imgModal img {max-width:93vw;max-height:88vh;border-radius:17px;box-shadow:0 2px 18px #111b;}
  </style>
</head>
<body>
<header>
  <div class="cabecera-wrap">
    <img id="cabeceraImg" alt="Dulce Vida" />
  </div>
</header>
<div class="marquesina"><div class="scroll" id="marquesinaScroll"></div></div>
<main>
  <!-- ...todo igual que antes (productos, carrito, cliente, etc)... -->
</main>
<!-- ...resto del html igual... -->
<script>
const scriptId = "YOUR_SCRIPT_ID";
const endpoint = "https://script.google.com/macros/s/AKfycbxnYsciq5EhfzgcgcF2FnyGECGarxqmF7zdDI0R9bizekqvB48W0RdBA4zZ0EGkDlWt/exec?func=catalogo";
const configEndpoint = "https://script.google.com/macros/s/AKfycbxnYsciq5EhfzgcgcF2FnyGECGarxqmF7zdDI0R9bizekqvB48W0RdBA4zZ0EGkDlWt/exec?func=config";
let productosData = [];
let carrito = [];
let cantidadesPorProducto = {};
let rellenosPorProducto = {};
let repartosConfig = [];
let repartosPrecios = {};
let velocidadMarquesina = 18;

function cargarConfiguraciones() {
  fetch(configEndpoint).then(r=>r.json()).then(config=>{
    // Marquesina
    document.getElementById('marquesinaScroll').textContent = config.anuncio || '¡Bienvenido!';
    velocidadMarquesina = config.velocidad || 18;
    repartosConfig = config.repartos || [];
    repartosPrecios = config.repartosPrecios || {};
    actualizarRepartos();
    setMarquesinaSpeed();
    // Imagen de cabecera
    if(config.cabeceraImg) {
      document.getElementById('cabeceraImg').src = config.cabeceraImg;
    }
  }).catch(()=>{
    document.getElementById('marquesinaScroll').textContent = "¡Bienvenido!";
    setMarquesinaSpeed();
  });
}
function setMarquesinaSpeed() {
  const el = document.querySelector('.marquesina .scroll');
  if(el) {
    el.style.animation = `scroll-lr ${velocidadMarquesina}s linear infinite`;
    el.style.webkitAnimation = `scroll-lr ${velocidadMarquesina}s linear infinite`;
  }
}
function actualizarRepartos() {
  const select = document.getElementById('reparto');
  select.innerHTML = '<option value="">Selecciona reparto</option>';
  repartosConfig.forEach(r=>{
    select.innerHTML += `<option value="${r}">${r}</option>`;
  });
}
cargarConfiguraciones();
// ...resto del JS igual...
</script>
</body>
</html>
